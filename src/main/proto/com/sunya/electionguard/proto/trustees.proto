syntax = "proto3";

import "com/sunya/electionguard/proto/common.proto";
import "com/sunya/electionguard/proto/key_ceremony.proto"; // LOOK

option java_package = "com.sunya.electionguard.proto";
option java_outer_classname = "TrusteeProto";

// LOOK replaces key_ceremony.proto ??

message DecryptingTrustees {
  repeated DecryptingTrustee trustees = 1;
}

message DecryptingTrustee {
  string guardian_id = 1;
  uint32 guardian_x_coordinate = 2;     // the x coefficient (sequence_order), must be > 0
  ElGamalKeyPair election_key_pair = 3;
  RSAPrivateKey rsa_private_key = 4;    // auxiliary private key
  // Other guardians' partial key backups shared with this guardian
  repeated ElectionPartialKeyBackup2 other_guardian_backups = 5;
  // The public keys K_ij generated from the election polynomial coefficients.
  // Duplicated here and in ElectionRecordProto.CoefficientValidationSet, to keep the trustee independent
  repeated CommitmentSet guardian_commitments = 6;
}

message CommitmentSet {
  string guardian_id = 1;
  repeated ElementModP commitments = 3; // coefficient commitments, always k (quorum) number
}

message ElectionPartialKeyBackup2 {
  // The Id of the guardian that generated this backup.
  string generating_guardian_id = 1;
  // The Id of the guardian to receive this backup.
  string designated_guardian_id = 2;
  // The x coefficient of the designated guardian.
  uint32 designated_guardian_x_coordinate = 3;
  // The encrypted coordinate of the designated guardian?.
  bytes encrypted_coordinate = 4;
}